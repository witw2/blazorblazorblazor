@page "/data-form"
@inject HttpClient Http
@inject ILogger<DataForm> Logger
@using MyBlazorApp.Models
@using System.Text.Json

<h3>Data Form</h3>

<form>
    <div>
        <label>Title:</label>
        <input @bind="dataItem.Name" />
    </div>
    <div>
        <label>Description:</label>
        <input @bind="dataItem.Price" type="number" />
    </div>
    <button type="button" @onclick="SaveData">Save</button>
</form>

@code {
    private DataItem dataItem = new();

    private async Task SaveData()
    {
        try
        {
            Logger.LogInformation("POST");
            var response = await Http.PostAsJsonAsync("https://localhost:5019/todo", dataItem);
            response.EnsureSuccessStatusCode();
            // Clear the form after successful save
            dataItem = new DataItem();
        }
        catch (HttpRequestException httpEx)
        {
            Logger.LogError($"HTTP error saving data: {httpEx.Message}");
        }
        catch (NotSupportedException nsEx)
        {
            Logger.LogError($"The content type is not supported: {nsEx.Message}");
        }
        catch (JsonException jsonEx)
        {
            Logger.LogError($"Error deserializing JSON: {jsonEx.Message}");
        }
        catch (Exception ex)
        {
            Logger.LogError($"Error saving data: {ex.Message}");
        }
    }
}


